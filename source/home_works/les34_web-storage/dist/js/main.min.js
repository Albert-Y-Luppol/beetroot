"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}!function(){var e,t=document.getElementById("search-start"),r=document.getElementById("search-no-result"),n=document.getElementById("article"),o=document.getElementById("tabs-container"),a=new AbortController,c=new AbortController,s=!1;function i(t){if(t.target.closest("button.description__favorite")){var r=t.target.closest("button.description__favorite");r.querySelector(".description__favorite-star").classList.toggle("description__favorite-star--full"),r.querySelector(".description__favorite-star--full")?e.add(r.closest("article.tabs__tab").getAttribute("data-imdb-i-d")):e.delete(r.closest("article.tabs__tab").getAttribute("data-imdb-i-d"))}}function l(e){function t(){document.forms.search.name.value=document.forms.search.autofill.value,document.forms.search.autofill.value=""}e.target.closest('input[name="name"].search__name')&&document.forms.search.autofill.value&&(document.forms.search.addEventListener("touchend",t,{once:!0}),setTimeout((function(){document.forms.search.removeEventListener("touchend",t,{once:!0})}),1e3))}function u(e){"ArrowRight"==e.code&&(document.forms.search.name.value=document.forms.search.autofill.value,document.forms.search.autofill.value="")}function d(){var t="";e.forEach((function(e){return t+=e+" "})),localStorage.setItem("favoriteMovies",t)}function m(t){t&&(_(),e.size?(b(),e.forEach((function(e){return function(e){var t=new URL("https://www.omdbapi.com");t.searchParams.set("apikey","bcd2d5b4"),t.searchParams.set("i",e),fetch(t).then((function(e){return e.json()})).then((function(e){!function(e){var t=n.cloneNode(!0),r=t.querySelector(".poster__img");r.addEventListener("load",f,{once:!0}),"N/A"!=e.Poster?r.src=e.Poster:r.src="./img/no-cover.png";r.alt=e.Title,t.querySelector(".description__title").innerHTML="".concat(e.Title),t.querySelector(".description__subtitle").innerHTML="Released in ".concat(e.Year," year"),t.dataset.imdbID=e.imdbID,t.querySelector("button.description__favorite").querySelector(".description__favorite-star").classList.toggle("description__favorite-star--full"),t.id="",t.querySelector(".description__main").innerHTML="<p>".concat("N/A"!=e.Plot?e.Plot:"","</p>"),"N/A"!=e.imdbRating&&(t.querySelector(".rate__amount").innerHTML=e.imdbRating,g(t));t.querySelector(".description__btn").remove(),t.classList.remove("tabs__tab--small"),t.querySelectorAll('[class*="--small"]').forEach((function(e){e.classList.remove(e.classList[0]+"--small")}))}(e)}))}(e)}))):p())}function f(e){var t=e.target.closest(".tabs__tab");o.append(t),t.classList.add("flipInX"),t.hidden=!1,y(t)}function h(e){if(e.target.closest('input[name="video-type"]')){"favorite"==document.forms.search.querySelector('input[name="video-type"]:checked').value&&m(e),document.forms.search.querySelector(".search__radio--before").classList.remove("search__radio--before"),document.forms.search.querySelector(".search__radio--after").classList.remove("search__radio--after");var t=function(e){for(var t=e.previousElementSibling;null!=t;){if(t.matches(".search__radio"))return t;t=t.previousElementSibling}return document.forms.search.querySelector(".search__stub--left")}(e.target.closest('input[name="video-type"]')),r=function(e){for(var t=e.nextElementSibling.nextElementSibling;null!=t;){if(t.matches(".search__radio"))return t;t=t.nextElementSibling}return document.forms.search.querySelector(".search__stub--right")}(e.target.closest('input[name="video-type"]'));if(t.classList.add("search__radio--before"),r.classList.add("search__radio--after"),"favorite"==e.target.closest('input[name="video-type"]').value)return void setTimeout(m,0)}document.forms.search.autofill.value="";var n=new URL("https://www.omdbapi.com");n.searchParams.set("apikey","bcd2d5b4"),n.searchParams.set("type","".concat(document.forms.search.querySelector('input[name="video-type"]:checked').value)),n.searchParams.set("t","".concat(document.forms.search.name.value)),a.abort(),a=new AbortController,fetch(n,{signal:a.signal}).then((function(e){return e.json()})).then((function(e){if("True"==e.Response){var t=e.Title;document.forms.search.name.value.toLowerCase()==t.slice(0,document.forms.search.name.value.length).toLowerCase()&&(document.forms.search.autofill.value=document.forms.search.name.value+t.slice(document.forms.search.name.value.length))}})).catch((function(e){if("AbortError"!=e.name)throw e}))}function v(e){if(e.preventDefault(),"favorite"!=document.forms.search.querySelector('input[name="video-type"]:checked').value){document.forms.search.name.select();var t=new URL("https://www.omdbapi.com");t.searchParams.set("apikey","bcd2d5b4"),t.searchParams.set("type","".concat(document.forms.search.querySelector('input[name="video-type"]:checked').value)),t.searchParams.set("s","".concat(document.forms.search.name.value)),t.searchParams.set("page",1),a.abort(),c.abort(),c=new AbortController,fetch(t,{signal:c.signal}).then((function(e){return e.json()})).then((function(e){"True"==e.Response?(t.searchParams.set("page",+t.searchParams.get("page")+1),_(e,t)):p()})).catch((function(e){if("AbortError"!=e.name)throw e}))}}function _(t,r){"favorite"==document.forms.search.querySelector('input[name="video-type"]:checked').value&&((t=new Object).Search=null),b();var a=[],i=t.Search;if(s=!0,window.addEventListener("scroll",l),"favorite"==document.forms.search.querySelector('input[name="video-type"]:checked').value)return window.removeEventListener("scroll",l),void(s=!1);function l(){if(s&&(function(){if(0==a.length)return document.getElementById("tab-loader").style.zIndex=1,void(document.getElementById("tab-loader").style.opacity=1);if(document.body.scrollHeight-(pageYOffset+document.documentElement.clientHeight)>100)return;var e=a.shift();e.classList.add("flipInX"),e.hidden=!1,o.append(e)}(),function(){if(i.length>5)return;c=new AbortController,fetch(r,{signal:c.signal}).then((function(e){return e.json()})).then((function(e){if("True"!=e.Response)return s=!1,void window.removeEventListener("scroll",l);r.searchParams.set("page",+r.searchParams.get("page")+1),i.push.apply(i,_toConsumableArray(e.Search)),l()})).catch((function(e){if("AbortError"!=e.name)throw e}))}(),0!=i.length&&!(a.length>5))){var t=n.cloneNode(!0),d=i.shift(),m=t.querySelector(".poster__img");if("N/A"!=d.Poster?m.src=d.Poster:m.src="./img/no-cover.png",m.alt=d.Title,m.addEventListener("load",(function(e){setTimeout((function(){a.push(t),document.getElementById("tab-loader").style.opacity=0,document.getElementById("tab-loader").addEventListener("transitionend",(function(e){e.target.style.zIndex=-1}),{once:!0}),l()}),0)}),{once:!0}),t.querySelector(".description__title").innerHTML="".concat(d.Title),t.querySelector(".description__subtitle").innerHTML="Released in ".concat(d.Year," year"),t.id="",t.dataset.imdbID=d.imdbID,e.has(d.imdbID))t.querySelector("button.description__favorite").querySelector(".description__favorite-star").classList.toggle("description__favorite-star--full");t.querySelector(".description__btn").addEventListener("click",u,{once:!0})}}function u(e){var t=e.target.closest(".tabs__tab"),r=e.target.closest(".description__btn"),n=t.getAttribute("data-imdb-i-d"),o=new URL("https://www.omdbapi.com");o.searchParams.set("apikey","bcd2d5b4"),o.searchParams.set("i",n),fetch(o).then((function(e){return e.json()})).then((function(e){t.querySelector(".description__main").innerHTML="<p>".concat("N/A"!=e.Plot?e.Plot:"","</p>"),"N/A"!=e.imdbRating&&(t.querySelector(".rate__amount").innerHTML=e.imdbRating,y(t),g(t))})),t.classList.remove("tabs__tab--small"),r.style.opacity=0,r.addEventListener("transitionend",(function(){r.remove(),t.scrollIntoView()}),{once:!0}),t.querySelectorAll('[class*="--small"]').forEach((function(e){e.classList.remove(e.classList[0]+"--small")}))}l()}function p(){b();var e=r.cloneNode(!0);e.id="",e.classList.add("flipInX"),e.hidden=!1,o.append(e)}function b(){o.querySelectorAll(".tabs__tab").forEach((function(e){e.remove()}))}function y(e){var t=e.querySelector(".rate__current > circle"),r=3.14*e.querySelector(".rate__maximal").offsetHeight,n=(10-+e.querySelector(".rate__amount").textContent)/10*r;t.style.strokeDashoffset=n}function g(e){for(var t=Math.round(e.querySelector(".rate__amount").innerHTML/2),r=e.querySelectorAll(".poster__star");t;)r[--t].classList.add("poster__star--full")}document.forms.search.name.focus(),document.body.querySelector(".tabs__tabs").append(t),t.hidden=!1,document.forms.search.addEventListener("input",h),document.forms.search.addEventListener("submit",v),document.forms.search.addEventListener("keydown",u),document.forms.search.addEventListener("touchstart",l),document.body.addEventListener("click",i),window.addEventListener("beforeunload",d),e=localStorage.getItem("favoriteMovies")?new Set(localStorage.getItem("favoriteMovies").trim().split(" ")):new Set}();
//# sourceMappingURL=main.min.js.map
