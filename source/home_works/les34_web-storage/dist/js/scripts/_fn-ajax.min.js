"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function handleInput(e){if(e.target.closest('input[name="video-type"]')){"favorite"==document.forms.search.querySelector('input[name="video-type"]:checked').value&&showFavoriteMovies(e),document.forms.search.querySelector(".search__radio--before").classList.remove("search__radio--before"),document.forms.search.querySelector(".search__radio--after").classList.remove("search__radio--after");var t=function(e){for(var t=e.previousElementSibling;null!=t;){if(t.matches(".search__radio"))return t;t=t.previousElementSibling}return document.forms.search.querySelector(".search__stub--left")}(e.target.closest('input[name="video-type"]')),r=function(e){for(var t=e.nextElementSibling.nextElementSibling;null!=t;){if(t.matches(".search__radio"))return t;t=t.nextElementSibling}return document.forms.search.querySelector(".search__stub--right")}(e.target.closest('input[name="video-type"]'));if(t.classList.add("search__radio--before"),r.classList.add("search__radio--after"),"favorite"==e.target.closest('input[name="video-type"]').value)return void setTimeout(showFavoriteMovies,0)}document.forms.search.autofill.value="";var o=new URL("https://www.omdbapi.com");o.searchParams.set("apikey","bcd2d5b4"),o.searchParams.set("type","".concat(document.forms.search.querySelector('input[name="video-type"]:checked').value)),o.searchParams.set("t","".concat(document.forms.search.name.value)),fetchController.abort(),fetchController=new AbortController,fetch(o,{signal:fetchController.signal}).then((function(e){return e.json()})).then((function(e){if("True"==e.Response){var t=e.Title;document.forms.search.name.value.toLowerCase()==t.slice(0,document.forms.search.name.value.length).toLowerCase()&&(document.forms.search.autofill.value=document.forms.search.name.value+t.slice(document.forms.search.name.value.length))}})).catch((function(e){if("AbortError"!=e.name)throw e}))}function handleSubmit(e){if(e.preventDefault(),"favorite"!=document.forms.search.querySelector('input[name="video-type"]:checked').value){document.forms.search.name.select();var t=new URL("https://www.omdbapi.com");t.searchParams.set("apikey","bcd2d5b4"),t.searchParams.set("type","".concat(document.forms.search.querySelector('input[name="video-type"]:checked').value)),t.searchParams.set("s","".concat(document.forms.search.name.value)),t.searchParams.set("page",1),fetchController.abort(),submitController.abort(),submitController=new AbortController,fetch(t,{signal:submitController.signal}).then((function(e){return e.json()})).then((function(e){"True"==e.Response?(t.searchParams.set("page",+t.searchParams.get("page")+1),showResults(e,t)):noResults()})).catch((function(e){if("AbortError"!=e.name)throw e}))}}function showResults(e,t){"favorite"==document.forms.search.querySelector('input[name="video-type"]:checked').value&&((e=new Object).Search=null),removeCurrentTabs();var r=[],o=e.Search;if(loadResultsFlag=!0,window.addEventListener("scroll",n),"favorite"==document.forms.search.querySelector('input[name="video-type"]:checked').value)return window.removeEventListener("scroll",n),void(loadResultsFlag=!1);function n(){if(loadResultsFlag&&(function(){if(0==r.length)return document.getElementById("tab-loader").style.zIndex=1,void(document.getElementById("tab-loader").style.opacity=1);if(document.body.scrollHeight-(pageYOffset+document.documentElement.clientHeight)>100)return;var e=r.shift();e.classList.add("flipInX"),e.hidden=!1,tabsConatainer.append(e)}(),function(){if(o.length>5)return;submitController=new AbortController,fetch(t,{signal:submitController.signal}).then((function(e){return e.json()})).then((function(e){if("True"!=e.Response)return loadResultsFlag=!1,void window.removeEventListener("scroll",n);t.searchParams.set("page",+t.searchParams.get("page")+1),o.push.apply(o,_toConsumableArray(e.Search)),n()})).catch((function(e){if("AbortError"!=e.name)throw e}))}(),0!=o.length&&!(r.length>5))){var e=defaultArticleTab.cloneNode(!0),s=o.shift(),c=e.querySelector(".poster__img");if("N/A"!=s.Poster?c.src=s.Poster:c.src="./img/no-cover.png",c.alt=s.Title,c.addEventListener("load",(function(t){setTimeout((function(){r.push(e),document.getElementById("tab-loader").style.opacity=0,document.getElementById("tab-loader").addEventListener("transitionend",(function(e){e.target.style.zIndex=-1}),{once:!0}),n()}),0)}),{once:!0}),e.querySelector(".description__title").innerHTML="".concat(s.Title),e.querySelector(".description__subtitle").innerHTML="Released in ".concat(s.Year," year"),e.id="",e.dataset.imdbID=s.imdbID,favoriteMovies.has(s.imdbID))e.querySelector("button.description__favorite").querySelector(".description__favorite-star").classList.toggle("description__favorite-star--full");e.querySelector(".description__btn").addEventListener("click",a,{once:!0})}}function a(e){var t=e.target.closest(".tabs__tab"),r=e.target.closest(".description__btn"),o=t.getAttribute("data-imdb-i-d"),n=new URL("https://www.omdbapi.com");n.searchParams.set("apikey","bcd2d5b4"),n.searchParams.set("i",o),fetch(n).then((function(e){return e.json()})).then((function(e){t.querySelector(".description__main").innerHTML="<p>".concat("N/A"!=e.Plot?e.Plot:"","</p>"),"N/A"!=e.imdbRating&&(t.querySelector(".rate__amount").innerHTML=e.imdbRating,setRate(t),setStars(t))})),t.classList.remove("tabs__tab--small"),r.style.opacity=0,r.addEventListener("transitionend",(function(){r.remove(),t.scrollIntoView()}),{once:!0}),t.querySelectorAll('[class*="--small"]').forEach((function(e){e.classList.remove(e.classList[0]+"--small")}))}n()}
//# sourceMappingURL=_fn-ajax.min.js.map
